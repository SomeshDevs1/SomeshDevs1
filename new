StringBuilder msgBody = new StringBuilder();
msgBody.append("<html>")
       .append("<h4> Link Batch Status for Working Date: ").append(formattedDate).append(" </h4><br>")
       .append("<style> table { border: 1px solid #dddddd; border-collapse: collapse; text-align: left; } </style>")
       .append("<table cellpadding='10' style='background-color: #eeeeee;'>")
       .append("<tr><th>Job Name</th><th>Job Execution</th><th>Status</th><th>Start Time</th><th>End Time</th></tr>");

// First table: Batch jobs
for (BatchJobDetailsDTO item : batchJob) {
    msgBody.append("<tr>")
           .append("<td>").append(item.getJobName()).append("</td>")
           .append("<td>").append(item.getJobExecutionId()).append("</td>")
           .append("<td>").append(item.getStatus()).append("</td>")
           .append("<td>").append(item.getStartTime()).append("</td>")
           .append("<td>").append(item.getEndTime()).append("</td>")
           .append("</tr>");
}
msgBody.append("</table><br>");

// Second table: Additional jobs from LinkBatchServiceImpl
msgBody.append("<h4> Additional Job Status </h4><table cellpadding='10' style='background-color: #eeeeee;'>")
       .append("<tr><th>Job Name</th><th>Job Execution</th><th>Status</th><th>Start Time</th><th>End Time</th></tr>");

// Assuming you have a method to retrieve additional jobs from LinkBatchServiceImpl
List<BatchJobDetailsDTO> additionalJobs = linkBatchService.getAdditionalJobs();
for (BatchJobDetailsDTO item : additionalJobs) {
    msgBody.append("<tr>")
           .append("<td>").append(item.getJobName()).append("</td>")
           .append("<td>").append(item.getJobExecutionId()).append("</td>")
           .append("<td>").append(item.getStatus()).append("</td>")
           .append("<td>").append(item.getStartTime()).append("</td>")
           .append("<td>").append(item.getEndTime()).append("</td>")
           .append("</tr>");
}
msgBody.append("</table><br>");

// Define the specific jobs, including the additional 4 jobs
Set<String> specificJobs = new HashSet<>(Arrays.asList(
    "clearMonitoringFund", 
    "populateChecklistWithCwdTaskStep", 
    "populateChecklistWithTbcTaskStep", 
    "GenerateChecklist",
    // Add the new specific jobs here
    "newJob1", 
    "newJob2", 
    "newJob3", 
    "newJob4"
));

boolean allJobsCompleted = true;
boolean specificJobsCompleted = true;  
boolean otherJobsCompleted = true;

for (BatchJobDetailsDTO item : batchJob) {
    if (!"COMPLETED".equals(item.getStatus())) {
        allJobsCompleted = false;

        if (specificJobs.contains(item.getJobName())) {
            specificJobsCompleted = false;
        } else {
            otherJobsCompleted = false;
        }
    }
}

// Evaluate additional jobs for specific job status
for (BatchJobDetailsDTO item : additionalJobs) {
    if (!"COMPLETED".equals(item.getStatus())) {
        allJobsCompleted = false;

        if (specificJobs.contains(item.getJobName())) {
            specificJobsCompleted = false;
        } else {
            otherJobsCompleted = false;
        }
    }
}

String overallStatus;
if (allJobsCompleted) {
    overallStatus = "OK";
} else if (otherJobsCompleted && !specificJobsCompleted) {
    overallStatus = "AMBER";
} else {
    overallStatus = "KO";
}

msgBody.append("<br><br><strong>Batch Overall Status: ").append(overallStatus).append("</strong>");
msgBody.append("</html>");

String subject = String.format("[LINK] Batch Status for %s %s", formattedDate, overallStatus);
emailService.sendBatchJobFailedMail(subject, msgBody.toString());

return null;



msgBody.append("<html>")
       .append("<h4> Link Batch Status for Working Date: ").append(formattedDate).append(" </h4><br>")
       .append("<style>")
       .append("table { border: 1px solid black; border-collapse: collapse; width: 100%; background-color: white; } ") // Set table background to white and border color to black
       .append("th { background-color: #eeeeee; border: 1px solid black; padding: 10px; } ") // Set header background to grey and border to black
       .append("td { border: 1px solid black; padding: 10px; } ") // Set data cell border to black
       .append("</style>")
       .append("<table>")
       .append("<tr><th>Job Name</th><th>Job Execution</th><th>Status</th><th>Start Time</th><th>End Time</th></tr>");

