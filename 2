for (Map<String, Object> authEntry : userAuthorizationList) {
    List<Map<String, Object>> permissions = (List<Map<String, Object>>) authEntry.get("permissions");

    if (permissions == null) continue;

    for (Map<String, Object> permission : permissions) {
        List<Map<String, Object>> constraints = (List<Map<String, Object>>) permission.get("constraints");
        if (constraints == null) continue;

        String applicationRole = null;
        String businessRole = null;
        String userType = null;
        List<String> moduleNames = new ArrayList<>();

        for (Map<String, Object> constraint : constraints) {
            String name = (String) constraint.get("name");
            List<String> values = (List<String>) constraint.get("values");

            if (name == null || values == null || values.isEmpty()) continue;

            switch (name) {
                case "ApplicationRole" -> applicationRole = values.get(0);
                case "Business Role"   -> businessRole = values.get(0);
                case "User Type"       -> userType = values.get(0);
                case "MODULE"          -> moduleNames.addAll(values); // Might have multiple module names
            }
        }

        for (String moduleName : moduleNames) {
            ModuleDto moduleDto = new ModuleDto();
            moduleDto.setId(String.valueOf(idModule));
            moduleDto.setModuleName(moduleName);
            moduleDto.setApplicationRole(applicationRole);
            moduleDto.setBusinessRole(businessRole);
            moduleDto.setUserType(userType);
            moduleDtos.add(moduleDto);
        }
    }
}